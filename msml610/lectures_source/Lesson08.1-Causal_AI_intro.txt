::: columns
:::: {.column width=15%}
![](msml610/lectures_source/figures/UMD_Logo.png)
::::
:::: {.column width=75%}

\vspace{0.4cm}
\begingroup \large
MSML610: Advanced Machine Learning
\endgroup
::::
:::

\vspace{1cm}

\begingroup \Large
**$$\text{\blue{8.1: Intro to Causal AI}}$$**
\endgroup

\vspace{1cm}

::: columns
:::: {.column width=75%}
**Instructor**: Dr. GP Saggese - [](gsaggese@umd.edu)

**References**:

- Hurwitz, Thompson: Causal Artificial Intelligence, 2024
::::
:::: {.column width=20%}

![](msml610/lectures_source/figures/book_covers/Book_cover_Causal_AI.jpg){width=1.5cm}

::::
:::

# ##############################################################################
# Causal AI
# ##############################################################################

// ## Why Causal AI?

## #############################################################################
## Why Causal AI?
## #############################################################################

* Big Data and Traditional AI
- For the past 10 years, **focus of analytics** on:
  - Organize and analyze massive amount of data
  - Data analytics (dashboards, models, reports)
  - Run machine learning on data

- Problems with **traditional AI**
  - Predicts based on observed correlations
  - Can't explain why an outcome occurred

- **AI in decision making**
  - Understand impact of decisions
  - E.g., _"What happens if a product price is reduced by 10%?"_
    - Will more customers buy?
    - If revenue decreases, what to do?
    - Why are customers leaving? Quality issue? Emerging competitor?

* What Are Data Analytics?
- **Collections of data**
  - Aggregated, organized data sets for analysis
  - E.g., customer purchase histories in a CRM system

- **Dashboards**
  - Visual displays of key metrics for insights
  - E.g., dashboard showing quarterly revenue, expenses

- **Descriptive statistics**
  - Summary metrics: mean, median, mode, standard deviation
  - E.g., average sales per quarter to understand trends

- **Historical reports**
  - Examination of past performance
  - E.g., monthly sales reports for past fiscal year

- **Models**
  - Statistical representations to forecast, explain phenomena
  - E.g., predictive model to anticipate customer churn based on behavioral data

* Data Analytics Sophistication

\begingroup \footnotesize
| **Business Question**       | **Methodology**                  |
|-----------------------------|----------------------------------|
| What happened?              | Descriptive statistics           |
| What will happen?           | Predictive models                |
| What should we do?          | Prescriptive programs            |
| What's the best we can do?  | Simulation + optimization        |
\endgroup

\begin{center}
  \includegraphics[width=0.9\textwidth]{msml610/lectures_source/figures/Lesson9-Analytical_sophistication.png}
\end{center}

* Explainability
- **Regulators** require that if you are making decisions using ML / AI, you
  should be able to defend the results of your analysis
  - E.g., decide who to hire, how to set up a policy

- Organizations can:
  - Be **fined** by regulatory authorities
  - Face **backlash** from customers and activists

- E.g., neural networks are "black boxes"
  - Lack of explainability
    - Humans can't understand how inputs are combined into a conclusion
    - Cannot explain to shareholders why certain decisions were made
  - Bias
    - E.g., using age, race, sex as a feature can introduce bias

- **Explainable AI** allow users to:
  - Comprehend
  - Explain
  - Trust the results by the machine

* Correlation is Not Causation!
- **Correlation** is a statistical method for understanding relationships
  between data
  - Pros
    - Use past outcomes to predict future outcomes by finding patterns and
      anomalies
  - Cons
    - Doesn't explain the cause
    - Variables may move together due to coincidence or a hidden factor

- **Causation** explains how changing one variable influences the other
  - Cannot be concluded from correlation alone

- **Data does not understand causes and effects**
  - Only humans can identify variables and relationships based on context
  - Without causation, you can't make intelligent decisions

* Causal AI
- **Understands the why**
  - Determines cause-and-effect between variables
  - E.g., whether a marketing campaign increased sales

- **Identify interventions**
  - Identifies variables and interventions to change outcomes
  - E.g., which lifestyle changes reduce blood pressure

- **Predicting counterfactuals**
  - Hypothesizes outcomes under different circumstances
  - E.g., student grades if they attended a different school

- **Avoiding bias**
  - Traditional AI biased by training data and ignored variables
  - Ensure fairness by accounting for confounding variables

- **Improving decision-making**
  - Provides understanding of relationships for better decisions
  - E.g., improving supply chain by understanding logistic impact

* Causal AI vs Traditional AI
- _"The next revolution of data science is the science of interpreting reality,
  not of summarizing data"_ (Judea Pearl, 2021)

- Current AI uses correlation to:
  - Analyze data
  - Identify patterns
  - Make predictions

- Models depend on data quality
  - Biased or unclean data $\implies$ poor model

## The Ladder of Causation

* The Ladder of Causation

- Pearl provided a 3-layer framework for understanding causality

\begingroup \scriptsize
| **Level**          | **Symbol**         | **Activity** | **Typical Questions**    |
| ------------------ | -------------------| -------------| ------------------------ |
| 1. Association     | $\Pr(Y | X)$       | Observing    | What is?                 |
| 2. Intervention    | $\Pr(Y | do(X), Z)$| Intervening  | What if?                 |
| 3. Counterfactuals | $\Pr(Y_X | x', y')$| Imagining    | Why?                     |
\endgroup

* Rung 1: Association
- **Question**: _"How would seeing $X$ change our belief in $Y$?"_

- **Symbol**: $\Pr(Y|X)$
  - Bayesian update

- **Activity**
  - It is just "passive observation"
  - Determine if two things are related
  - Traditional AI and ML is based on this

- **Example**
  - _"The tree has green leaves during spring"_
  - _"What does a symptom tell you about a disease?"_
  - _"What does a survey tell you about the election results?"_

* Rung 2: Intervention
- **Question**: _"What happens to $Y$ if you do $X$?"_

- **Symbol**: $\Pr(Y | do(X), Z)$

- **Activity**
  - Understand the impact of an action
  - E.g., _"tree has green leaves"_ vs _"spring makes tree leaves turn green"_
  - Association is just about observations
  - Interventions involve "doing something" and need a causal model

- **Example**
  - _"Why did the headache go away?"_
    - "Because the pain reliever" or "Because you ate food after skipping lunch"
  - _"If you take aspirin, will your headache be cured?"_
  - _"What if you ban sodas?"_

* Rung 3: Counterfactuals
- **Question**: _"Was $X$ that caused $Y$?"_

- **Symbol**: $\Pr(Y_X | x', y')$

- **Activity**:
  - Imagine what will happen if facts were different
  - Predicting an outcome is the highest form of reasoning
    - It requires to understand relationships between cause and effect

- **Example**
  - Scientific experiments: _"What if we give a child an adult dose of a drug?"_
  - Litigation: _"What would the jury conclude?"_
  - Marketing: _"Why did my marketing campaign fail to generate sales?"_

// # Chap 3: Elements of Causal AI (Causal_AI_in_business.Hurwitz.2023.txt)

## #############################################################################
## Correlation vs Causation Models
## #############################################################################

* Correlation vs Causation Model
- **Correlation** = identify how variables are related to each other
- **Causality** = determine whether one variable causes another variable

  - Both:
    - Accept inputs and transform them to compute predictions
    - Identify how variables are related to each other

  - Correlation-based AI works well when there is abundant historical and
    observational data
  - Causal-based AI first creates a business-focused model before integrating data

* Correlation-Based Model Process
- **Correlation-based AI** is "data first"
  - The more data collected the better

- **Modeling process**
  - Acquire data
  - Integrate and clean data
  - Exploratory data analysis (EDA)
  - Feature engineering
  - Build and test models
  - Deploy models in production

- **Many AI projects fail because**
  - Cultural and organizational issues
  - Models are opaque and lack explainability
  - Spurious correlations
  - Missing articulating "what's the goal of doing ML?"

* Causation-based Model Process
- **Causal AI** is "model first"
  - Understand business question before ingest and transform the data

- **Modeling process**
  - What is the intended outcome?
  - What is the proposed intervention?
  - What are the confounding factors?
  - What are the effecting factors?
  - Create a model graph or diagram
  - Data acquisition
  - ...
